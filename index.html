<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MTK Miner - Real Test Tokens</title>
    <style>
        :root {
            --primary: #f8c555;
            --success: #2ed573;
            --warning: #ffa502;
            --error: #ff4757;
            --info: #1e90ff;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .card { background: rgba(0,0,0,0.7); border-radius: 15px; padding: 25px; margin-bottom: 20px; }
        h1 { text-align: center; margin-bottom: 30px; color: var(--primary); }
        h2 { color: var(--primary); margin-bottom: 20px; }
        .btn { background: var(--primary); color: #000; border: none; padding: 12px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; margin: 10px 5px; display: inline-flex; align-items: center; gap: 8px; }
        .btn-success { background: var(--success); }
        .btn-info { background: var(--info); }
        .btn-warning { background: var(--warning); }
        .info-box { background: rgba(248,197,85,0.1); border: 2px solid var(--primary); border-radius: 10px; padding: 15px; margin: 15px 0; }
        .faucet-list { display: grid; gap: 15px; margin: 20px 0; }
        .faucet-item { background: rgba(255,255,255,0.05); border-radius: 10px; padding: 15px; }
        .token-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .token-card { background: rgba(46,213,115,0.1); border: 2px solid var(--success); border-radius: 10px; padding: 15px; }
        .notification { position: fixed; top: 20px; right: 20px; padding: 15px 25px; background: var(--primary); color: #000; border-radius: 8px; font-weight: bold; transform: translateX(150%); transition: transform 0.3s; z-index: 1000; }
        .notification.show { transform: translateX(0); }
        .hidden { display: none; }
        .step { display: flex; align-items: center; margin: 15px 0; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px; }
        .step-number { background: var(--primary); color: #000; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 15px; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü™ô Get Real Test Tokens on Sepolia</h1>
        
        <!-- Connection Status -->
        <div class="card">
            <h2>üîó Wallet Connection</h2>
            <div class="info-box">
                <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                    <span style="color: var(--primary); font-weight: bold;">Status:</span>
                    <span id="walletStatus" style="font-family: monospace;">Not Connected</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                    <span style="color: var(--primary); font-weight: bold;">Account:</span>
                    <span id="accountAddress" style="font-family: monospace;">-</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                    <span style="color: var(--primary); font-weight: bold;">Network:</span>
                    <span id="networkInfo" style="font-family: monospace;">-</span>
                </div>
                <button class="btn" onclick="connectWallet()" id="connectBtn" style="width: 100%; margin-top: 15px;">
                    üîó Connect MetaMask
                </button>
            </div>
        </div>

        <!-- Step-by-Step Guide -->
        <div class="card">
            <h2>üìã Step-by-Step Guide</h2>
            
            <div class="step">
                <div class="step-number">1</div>
                <div>
                    <strong>Connect Wallet & Switch to Sepolia</strong>
                    <div style="color: #aaa; font-size: 14px; margin-top: 5px;">Make sure you're on Sepolia Test Network</div>
                </div>
            </div>
            
            <div class="step">
                <div class="step-number">2</div>
                <div>
                    <strong>Get Sepolia ETH (Free)</strong>
                    <div style="color: #aaa; font-size: 14px; margin-top: 5px;">You need ETH for gas fees</div>
                </div>
            </div>
            
            <div class="step">
                <div class="step-number">3</div>
                <div>
                    <strong>Get Test Tokens (Free)</strong>
                    <div style="color: #aaa; font-size: 14px; margin-top: 5px;">Choose from the faucets below</div>
                </div>
            </div>
            
            <div class="step">
                <div class="step-number">4</div>
                <div>
                    <strong>Start Mining & Withdrawing</strong>
                    <div style="color: #aaa; font-size: 14px; margin-top: 5px;">Test withdrawals with real tokens</div>
                </div>
            </div>
        </div>

        <!-- ETH Faucets -->
        <div class="card">
            <h2>‚õΩ ETH Faucets (Get Free Sepolia ETH)</h2>
            <div class="faucet-list">
                <div class="faucet-item">
                    <h3 style="color: var(--success);">1. Alchemy Sepolia Faucet</h3>
                    <p style="margin: 10px 0; color: #aaa;">Best faucet - requires Alchemy account (free)</p>
                    <button class="btn btn-success" onclick="window.open('https://sepoliafaucet.com', '_blank')">
                        üöÄ Go to Alchemy Faucet
                    </button>
                    <div style="margin-top: 10px; font-size: 14px; color: var(--primary);">
                        ‚úÖ Get 0.5 ETH every 24 hours
                    </div>
                </div>
                
                <div class="faucet-item">
                    <h3 style="color: var(--info);">2. Infura Sepolia Faucet</h3>
                    <p style="margin: 10px 0; color: #aaa;">Infura account required (free)</p>
                    <button class="btn btn-info" onclick="window.open('https://www.infura.io/faucet/sepolia', '_blank')">
                        üíß Go to Infura Faucet
                    </button>
                </div>
                
                <div class="faucet-item">
                    <h3 style="color: var(--warning);">3. QuickNode Faucet</h3>
                    <p style="margin: 10px 0; color: #aaa;">Twitter verification required</p>
                    <button class="btn btn-warning" onclick="window.open('https://faucet.quicknode.com/ethereum/sepolia', '_blank')">
                        ‚ö° Go to QuickNode Faucet
                    </button>
                </div>
            </div>
            
            <div class="info-box">
                <strong>üí° Tips:</strong>
                <ul style="margin: 10px 0 0 20px; color: #aaa;">
                    <li>Alchemy faucet is most reliable</li>
                    <li>You need ETH for gas fees (0.1 ETH is enough for testing)</li>
                    <li>Faucets have daily limits</li>
                </ul>
            </div>
        </div>

        <!-- Test Token Faucets -->
        <div class="card">
            <h2>ü™ô Test Token Faucets (Get Real ERC20 Tokens)</h2>
            
            <div class="token-grid">
                <div class="token-card">
                    <h3 style="color: var(--success);">UNI Token</h3>
                    <p style="margin: 10px 0; color: #aaa; font-size: 14px;">Uniswap Governance Token</p>
                    <div style="font-family: monospace; font-size: 12px; color: var(--primary); margin: 5px 0;">
                        Contract: 0x1f984...BDADdC4201F984
                    </div>
                    <button class="btn btn-success" onclick="getUniTokens()">
                        üéÅ Get UNI Tokens
                    </button>
                </div>
                
                <div class="token-card">
                    <h3 style="color: var(--info);">LINK Token</h3>
                    <p style="margin: 10px 0; color: #aaa; font-size: 14px;">Chainlink Oracle Token</p>
                    <div style="font-family: monospace; font-size: 12px; color: var(--primary); margin: 5px 0;">
                        Contract: 0x779877...0cF956
                    </div>
                    <button class="btn btn-info" onclick="getLinkTokens()">
                        üîó Get LINK Tokens
                    </button>
                </div>
                
                <div class="token-card">
                    <h3 style="color: var(--warning);">DAI Token</h3>
                    <p style="margin: 10px 0; color: #aaa; font-size: 14px;">Stablecoin Test Token</p>
                    <div style="font-family: monospace; font-size: 12px; color: var(--primary); margin: 5px 0;">
                        Contract: 0x3e622...C620C5d6
                    </div>
                    <button class="btn btn-warning" onclick="getDaiTokens()">
                        üí∞ Get DAI Tokens
                    </button>
                </div>
            </div>
            
            <div class="info-box">
                <strong>üìù How to Get Test Tokens:</strong>
                <ol style="margin: 10px 0 0 20px; color: #aaa;">
                    <li>First get Sepolia ETH (from faucets above)</li>
                    <li>Go to Uniswap on Sepolia: <a href="https://app.uniswap.org" style="color: var(--primary);" target="_blank">app.uniswap.org</a></li>
                    <li>Connect your wallet (make sure it's on Sepolia)</li>
                    <li>Swap ETH for UNI, LINK, or other tokens</li>
                    <li>Use small amounts (0.01 ETH) for testing</li>
                </ol>
            </div>
        </div>

        <!-- Token Withdrawal Test -->
        <div class="card">
            <h2>üí∏ Test Token Withdrawal</h2>
            <div id="withdrawalSection" class="hidden">
                <div class="info-box">
                    <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                        <span style="color: var(--primary); font-weight: bold;">Selected Token:</span>
                        <span id="selectedToken" style="font-family: monospace;">-</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin: 10px 0;">
                        <span style="color: var(--primary); font-weight: bold;">Your Balance:</span>
                        <span id="tokenBalance" style="font-family: monospace;">0 tokens</span>
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <label style="color: var(--primary); font-weight: bold; display: block; margin-bottom: 5px;">Withdraw Amount</label>
                        <input type="number" id="withdrawAmount" placeholder="Enter amount" value="1" min="0.1" step="0.1" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid var(--primary); background: rgba(255,255,255,0.05); color: white;">
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <label style="color: var(--primary); font-weight: bold; display: block; margin-bottom: 5px;">Recipient Address</label>
                        <input type="text" id="recipientAddress" placeholder="0x..." value="0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid var(--primary); background: rgba(255,255,255,0.05); color: white;">
                        <div style="font-size: 12px; color: #aaa; margin-top: 5px;">
                            Test address (Hardhat default) or enter your own
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="testWithdrawal()" style="width: 100%;">
                        üß™ Test Withdrawal
                    </button>
                </div>
            </div>
            <div id="connectFirstMessage" style="text-align: center; padding: 20px; color: #aaa;">
                Connect your wallet to test withdrawals
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="card">
            <h2>‚ö° Quick Actions</h2>
            <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px;">
                <button class="btn" onclick="switchToSepolia()">
                    üîÑ Switch to Sepolia
                </button>
                <button class="btn btn-info" onclick="copyAddress()">
                    üìã Copy My Address
                </button>
                <button class="btn btn-success" onclick="checkBalances()">
                    üí∞ Check All Balances
                </button>
                <button class="btn btn-warning" onclick="openUniswap()">
                    üîÑ Open Uniswap
                </button>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div class="notification" id="notification"></div>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const TOKENS = {
            UNI: {
                address: '0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984',
                name: 'Uniswap',
                symbol: 'UNI',
                decimals: 18,
                faucet: 'https://app.uniswap.org/swap'
            },
            LINK: {
                address: '0x779877A7B0D9E8603169DdbD7836e478b4624789',
                name: 'Chainlink',
                symbol: 'LINK',
                decimals: 18,
                faucet: 'https://faucets.chain.link/sepolia'
            },
            DAI: {
                address: '0x3e622317f8C93f7328350cF0B56d9eD4C620C5d6',
                name: 'DAI Stablecoin',
                symbol: 'DAI',
                decimals: 18,
                faucet: 'https://app.uniswap.org/swap'
            },
            USDC: {
                address: '0x94a9D9AC8a22534E3FaCa9F4e7F2E2cf85d5E4C8',
                name: 'USD Coin',
                symbol: 'USDC',
                decimals: 6,
                faucet: 'https://app.uniswap.org/swap'
            }
        };

        // ============================================
        // WALLET CONNECTION
        // ============================================
        let web3 = null;
        let userAccount = null;
        let connected = false;
        let selectedToken = TOKENS.UNI;

        async function connectWallet() {
            try {
                if (typeof window.ethereum === 'undefined') {
                    showNotification('Please install MetaMask!', 'error');
                    return;
                }

                const accounts = await window.ethereum.request({ 
                    method: 'eth_requestAccounts' 
                });
                
                if (accounts.length === 0) {
                    showNotification('Please unlock MetaMask!', 'error');
                    return;
                }
                
                userAccount = accounts[0];
                web3 = new Web3(window.ethereum);
                
                // Check network
                const chainId = await web3.eth.getChainId();
                const isSepolia = chainId === 11155111;
                
                // Update UI
                document.getElementById('walletStatus').textContent = 'Connected ‚úì';
                document.getElementById('accountAddress').textContent = 
                    userAccount.substring(0, 6) + '...' + userAccount.substring(38);
                document.getElementById('networkInfo').textContent = 
                    isSepolia ? 'Sepolia ‚úì' : `Wrong Network (ID: ${chainId})`;
                
                document.getElementById('connectBtn').textContent = '‚úÖ Connected';
                document.getElementById('connectBtn').disabled = true;
                
                connected = true;
                
                // Show withdrawal section
                document.getElementById('withdrawalSection').classList.remove('hidden');
                document.getElementById('connectFirstMessage').classList.add('hidden');
                
                // Check balances
                await checkBalances();
                
                showNotification('Wallet connected! Switch to Sepolia if not already.', 'success');
                
                if (!isSepolia) {
                    showNotification('Please switch to Sepolia testnet!', 'warning');
                }
                
            } catch (error) {
                console.error('Connection error:', error);
                showNotification('Connection failed: ' + error.message, 'error');
            }
        }

        // ============================================
        // NETWORK FUNCTIONS
        // ============================================
        async function switchToSepolia() {
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0xaa36a7' }], // Sepolia
                });
                showNotification('Switched to Sepolia!', 'success');
                setTimeout(() => location.reload(), 1000);
            } catch (error) {
                if (error.code === 4902) {
                    // Add Sepolia network
                    await window.ethereum.request({
                        method: 'wallet_addEthereumChain',
                        params: [{
                            chainId: '0xaa36a7',
                            chainName: 'Sepolia Test Network',
                            nativeCurrency: {
                                name: 'Sepolia ETH',
                                symbol: 'ETH',
                                decimals: 18
                            },
                            rpcUrls: ['https://rpc.sepolia.org'],
                            blockExplorerUrls: ['https://sepolia.etherscan.io']
                        }]
                    });
                    setTimeout(() => location.reload(), 1000);
                } else {
                    showNotification('Failed to switch network: ' + error.message, 'error');
                }
            }
        }

        // ============================================
        // TOKEN FUNCTIONS
        // ============================================
        async function checkBalances() {
            if (!connected || !web3) return;
            
            try {
                showNotification('Checking balances...', 'info');
                
                // Check ETH balance
                const ethBalance = await web3.eth.getBalance(userAccount);
                const ethFormatted = web3.utils.fromWei(ethBalance, 'ether');
                
                // Check selected token balance
                const tokenContract = new web3.eth.Contract(getERC20ABI(), selectedToken.address);
                const tokenBalance = await tokenContract.methods.balanceOf(userAccount).call();
                const decimals = await tokenContract.methods.decimals().call();
                const tokenFormatted = tokenBalance / Math.pow(10, decimals);
                
                // Update UI
                document.getElementById('selectedToken').textContent = 
                    `${selectedToken.symbol} (${selectedToken.name})`;
                document.getElementById('tokenBalance').textContent = 
                    `${tokenFormatted.toFixed(4)} ${selectedToken.symbol}`;
                
                showNotification(`Balance: ${ethFormatted.substring(0, 6)} ETH, ${tokenFormatted.toFixed(2)} ${selectedToken.symbol}`, 'success');
                
            } catch (error) {
                console.error('Balance check error:', error);
                showNotification('Balance check failed', 'error');
            }
        }

        function getUniTokens() {
            selectedToken = TOKENS.UNI;
            showNotification('Selected UNI token. Get UNI on Uniswap!', 'info');
            openUniswap();
        }

        function getLinkTokens() {
            selectedToken = TOKENS.LINK;
            window.open('https://faucets.chain.link/sepolia', '_blank');
            showNotification('Opening Chainlink faucet for LINK tokens...', 'info');
        }

        function getDaiTokens() {
            selectedToken = TOKENS.DAI;
            showNotification('Selected DAI token. Get DAI on Uniswap!', 'info');
            openUniswap();
        }

        function openUniswap() {
            window.open('https://app.uniswap.org/swap', '_blank');
            showNotification('Opening Uniswap. Connect wallet and swap ETH for tokens!', 'info');
        }

        // ============================================
        // WITHDRAWAL TEST
        // ============================================
        async function testWithdrawal() {
            if (!connected || !web3) {
                showNotification('Please connect wallet first!', 'error');
                return;
            }
            
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const recipient = document.getElementById('recipientAddress').value.trim();
            
            if (!amount || amount <= 0) {
                showNotification('Please enter a valid amount', 'error');
                return;
            }
            
            if (!recipient || !web3.utils.isAddress(recipient)) {
                showNotification('Please enter a valid recipient address', 'error');
                return;
            }
            
            try {
                // Create token contract
                const tokenContract = new web3.eth.Contract(getERC20ABI(), selectedToken.address);
                
                // Get decimals
                const decimals = await tokenContract.methods.decimals().call();
                const amountInWei = web3.utils.toWei(amount.toString(), 'ether');
                
                // Check balance
                const balance = await tokenContract.methods.balanceOf(userAccount).call();
                const balanceFormatted = balance / Math.pow(10, decimals);
                
                if (balanceFormatted < amount) {
                    showNotification(`Insufficient ${selectedToken.symbol} balance! You have ${balanceFormatted.toFixed(4)}`, 'error');
                    return;
                }
                
                // Send transaction
                showNotification(`Sending ${amount} ${selectedToken.symbol}...`, 'info');
                
                const tx = await tokenContract.methods.transfer(
                    recipient, 
                    amountInWei
                ).send({ 
                    from: userAccount,
                    gas: 100000
                });
                
                showNotification(`‚úÖ Success! ${amount} ${selectedToken.symbol} sent!`, 'success');
                
                // Show transaction link
                const explorerLink = `https://sepolia.etherscan.io/tx/${tx.transactionHash}`;
                setTimeout(() => {
                    showNotification(`View transaction on Etherscan`, 'info');
                    console.log('Transaction:', explorerLink);
                }, 2000);
                
                // Update balance
                setTimeout(() => checkBalances(), 3000);
                
            } catch (error) {
                console.error('Withdrawal error:', error);
                
                if (error.message.includes('insufficient funds')) {
                    showNotification('Insufficient ETH for gas fees! Get more ETH from faucet.', 'error');
                } else if (error.message.includes('rejected')) {
                    showNotification('Transaction rejected by user', 'error');
                } else {
                    showNotification('Withdrawal failed: ' + error.message, 'error');
                }
            }
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function copyAddress() {
            if (!userAccount) {
                showNotification('Connect wallet first!', 'error');
                return;
            }
            
            navigator.clipboard.writeText(userAccount);
            showNotification('Address copied to clipboard!', 'success');
        }

        function getERC20ABI() {
            return [
                {
                    "constant": true,
                    "inputs": [],
                    "name": "name",
                    "outputs": [{"name": "", "type": "string"}],
                    "type": "function"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "symbol",
                    "outputs": [{"name": "", "type": "string"}],
                    "type": "function"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "decimals",
                    "outputs": [{"name": "", "type": "uint8"}],
                    "type": "function"
                },
                {
                    "constant": true,
                    "inputs": [{"name": "_owner", "type": "address"}],
                    "name": "balanceOf",
                    "outputs": [{"name": "balance", "type": "uint256"}],
                    "type": "function"
                },
                {
                    "constant": false,
                    "inputs": [
                        {"name": "_to", "type": "address"},
                        {"name": "_value", "type": "uint256"}
                    ],
                    "name": "transfer",
                    "outputs": [{"name": "success", "type": "bool"}],
                    "type": "function"
                }
            ];
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification';
            
            const colors = {
                'error': '#ff4757',
                'success': '#2ed573',
                'warning': '#ffa502',
                'info': '#1e90ff'
            };
            
            notification.style.background = colors[type] || '#f8c555';
            
            setTimeout(() => notification.classList.add('show'), 10);
            setTimeout(() => notification.classList.remove('show'), 3000);
        }

        // Initialize
        window.onload = function() {
            // Check if already connected
            if (typeof window.ethereum !== 'undefined') {
                window.ethereum.request({ method: 'eth_accounts' })
                    .then(accounts => {
                        if (accounts.length > 0) {
                            connectWallet();
                        }
                    });
            }
            
            // Listen for account changes
            if (window.ethereum) {
                window.ethereum.on('accountsChanged', () => {
                    location.reload();
                });
                window.ethereum.on('chainChanged', () => {
                    location.reload();
                });
            }
        };
    </script>
    
    <!-- Web3.js -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.7.0/dist/web3.min.js"></script>
</body>
</html>
